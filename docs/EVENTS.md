
---

# üìò **docs/EVENTS.md ‚Äî –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π (Event)**

Notification API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞.
–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é **–æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö NotificationJob**, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Kafka.

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç —ç—Ç–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã.

---

# 1. üì¶ –§–æ—Ä–º–∞—Ç Event

```json
{
  "event_id": "uuid",
  "event_type": "string",
  "source": "string",
  "occurred_at": "ISO datetime",
  "payload": {}
}
```

---

## 1.1. üß± –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

| –ü–æ–ª–µ          | –¢–∏–ø      | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ------------- | -------- | ------------------------------------------ |
| `event_id`    | UUID     | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏—è           |
| `event_type`  | string   | –¢–∏–ø —Å–æ–±—ã—Ç–∏—è (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É payload) |
| `source`      | string   | –ò—Å—Ç–æ—á–Ω–∏–∫ ‚Äî —Å–µ—Ä–≤–∏—Å-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å              |
| `occurred_at` | datetime | –ö–æ–≥–¥–∞ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ                    |
| `payload`     | object   | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–±—ã—Ç–∏—è                         |

---

# 2. üìö –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è (MVP)

–ù–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π.

---

# 2.1. `user_registered`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### Payload

```json
{
  "user_id": "uuid",
  "registration_channel": "web",
  "locale": "ru",
  "user_agent": "Mozilla/5.0"
}
```

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è

```json
{
  "event_id": "6a9f7f26-4c0c-4a91-9f3d-b159c2dcb001",
  "event_type": "user_registered",
  "source": "auth_service",
  "occurred_at": "2025-11-14T12:34:56Z",
  "payload": {
    "user_id": "f3aa4a0e-97d4-4e21-a2b4-9fb7c8d9f001",
    "registration_channel": "web",
    "locale": "ru",
    "user_agent": "Mozilla/5.0"
  }
}
```

---

# 2.2. `new_film_released`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ñ–∏–ª—å–º–∞.

### Payload

```json
{
  "film_id": "uuid",
  "title": "string",
  "genres": ["sci-fi", "action"],
  "age_rating": "16+",
  "release_date": "2025-11-15",
  "target_segment": {
    "by_genres": ["sci-fi"],
    "min_age": 16
  }
}
```

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è

```json
{
  "event_id": "a1b2c3d4-0000-0000-0000-000000000001",
  "event_type": "new_film_released",
  "source": "content_service",
  "occurred_at": "2025-11-14T13:00:00Z",
  "payload": {
    "film_id": "5fcc8705-30be-467d-b5e0-e17ab03ff59b",
    "title": "The Matrix",
    "genres": ["sci-fi", "action"],
    "age_rating": "16+",
    "release_date": "2025-11-15",
    "target_segment": {
      "by_genres": ["sci-fi", "action"],
      "min_age": 16
    }
  }
}
```

---

# 2.3. `campaign_triggered`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª—å—é –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫.

### Payload

```json
{
  "campaign_id": "uuid",
  "template_code": "black_friday_sale",
  "channels": ["email", "push"],
  "segment": {
    "segment_id": "bf_2025_loyal_customers"
  }
}
```

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è

```json
{
  "event_id": "c1d2e3f4-0000-0000-0000-000000000001",
  "event_type": "campaign_triggered",
  "source": "admin_panel",
  "occurred_at": "2025-11-14T14:00:00Z",
  "payload": {
    "campaign_id": "9f3d5a5e-0000-0000-0000-000000000001",
    "template_code": "black_friday_sale",
    "channels": ["email", "push"],
    "segment": {
      "segment_id": "bf_2025_loyal_customers"
    }
  }
}
```

---

# üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

* `payload` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–∏–ø—É `event_type`.
* API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **400 Bad Request**, –µ—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ payload –Ω–∞—Ä—É—à–µ–Ω–∞.
* –î–ª—è –∫–∞–∂–¥–æ–≥–æ `event_type` Notification API —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ `NotificationJob`.
* –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ worker ‚Äî —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –ø–∞–π–ø–ª–∞–π–Ω–∞ –≤ API.

---

